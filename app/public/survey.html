<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://code.jquery.com/jquery.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <title>Survey</title>
</head>

<body>

    <div class="container">

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-10 text-center">

                <h1>Survey questions</h1>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <hr>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-10">

                <form>

                    <div class="form-group">
                        <label for="name">
                            <h5>Name (required):</h5>
                        </label>
                        <input type="name" class="form-control" id="name" placeholder="Enter name">
                    </div>

                    <div class="form-group">
                        <label for="pic">
                            <h5>Link to picture (required):</h5>
                        </label>
                        <input type="link" class="form-control" id="pic" placeholder="Link to pic">
                    </div>

                </form>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <hr>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-5">

                <h6>Rate oranges:</h6>
                <select class="custom-select" id="q1">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-5">

                <h6>Rate rap music:</h6>
                <select class="custom-select" id="q2">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-5">

                <h6>Rate Bitcoin:</h6>
                <select class="custom-select" id="q3">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-5">

                <h6>Rate jogging:</h6>
                <select class="custom-select" id="q4">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-5">

                <h6>Rate Mad Max Fury Road:</h6>
                <select class="custom-select" id="q5">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-5">

                <h6>Rate SQL:</h6>
                <select class="custom-select" id="q6">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-5">

                <h6>Rate carnitas:</h6>
                <select class="custom-select" id="q7">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-5">

                <h6>Rate Tulum:</h6>
                <select class="custom-select" id="q8">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-5">

                <h6>Rate Frank Ocean:</h6>
                <select class="custom-select" id="q9">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-5">

                <h6>Rate MERN stack:</h6>
                <select class="custom-select" id="q10">
                    <option selected>Rate</option>
                    <option value="1">1 (hate)</option>
                    <option value="2">2 (dislike)</option>
                    <option value="3">3 (meh)</option>
                    <option value="4">4 (cool)</option>
                    <option value="5">5 (love)</option>
                </select>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div class="row">

            <div class="col-lg-1"></div>

            <div class="col-lg-10 text-center">

                <button type="button" class="btn btn-dark" id="submit">Submit</button>

            </div>

            <div class="col-lg-1"></div>

        </div>

        <br>

        <div id="results-modal" class="modal fade text-center" role="dialog">

            <div class="modal-dialog">

                <div class="modal-content">

                    <div class="modal-header">

                        <h6 class="modal-title"><strong>Your best match:</strong></h6>

                    </div>

                    <div class="modal-body">

                        <h6 id="match-name"></h6>
                        <img id="match-img" src="" alt="pic">

                    </div>

                    <div class="modal-footer">

                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

                    </div>

                </div>

            </div>

        </div>

    </div>

</body>

<script>

    $("#submit").on("click", function (event) {

        event.preventDefault();

        let friendName = $("#name").val().trim();
        let friendPic = $("#pic").val().trim();
        let q1 = $("#q1").val().trim();
        let q2 = $("#q2").val().trim();
        let q3 = $("#q3").val().trim();
        let q4 = $("#q4").val().trim();
        let q5 = $("#q5").val().trim();
        let q6 = $("#q6").val().trim();
        let q7 = $("#q7").val().trim();
        let q8 = $("#q8").val().trim();
        let q9 = $("#q9").val().trim();
        let q10 = $("#q10").val().trim();

        let resultsArr = [];

        let qs = [];

        let newRes;

        function checkOptions() {

            qs.push(q1);
            qs.push(q2);
            qs.push(q3);
            qs.push(q4);
            qs.push(q5);
            qs.push(q6);
            qs.push(q7);
            qs.push(q8);
            qs.push(q9);
            qs.push(q10);

            function allTrue(n) {

                if (n === "Rate" || n === " ") {

                    return false;

                } else {

                    return true;

                }

            }

            let noRB = qs.every(allTrue);

            if (noRB === true) {

                qs.forEach(element => {

                    resultsArr.push(element);

                });

                newRes = {
                    name: friendName,
                    pic: friendPic,
                    resultsArr,
                }

                $.post("/api/friends", newRes, function (data) {

                    console.log(`posting: ${data}`);
    
                    $("#match-name").text(data.name);
                    $("#match-img").attr("src", data.pic);

                    $("#results-modal").modal("toggle");

                });

                $("#name").val("");
                $("#pic").val("");
                $("#q1").val("");
                $("#q2").val("");
                $("#q3").val("");
                $("#q4").val("");
                $("#q5").val("");
                $("#q6").val("");
                $("#q7").val("");
                $("#q8").val("");
                $("#q9").val("");
                $("#q10").val("");

            } else {

                alert("Please fill ALL the fields.");

            }

        }

        if (friendName.length > 0 && friendPic.length > 0) {

            checkOptions();

        } else {

            alert("Please fill ALL the fields.");

        }

    });

</script>

</html>